<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WARP.JOBS // DATA EXPLORER</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-color: #050505;
            --glass-panel: rgba(10, 15, 20, 0.7);
            --glass-border: rgba(0, 240, 255, 0.15);
            --text-main: #e0f2f1;
            --text-muted: #546e7a;
            --accent-cyan: #00f0ff;
            --accent-purple: #d500f9;
            --accent-success: #00e676;
            --font-mono: 'JetBrains Mono', monospace;
            --font-sans: 'Inter', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: radial-gradient(circle at 50% 50%, rgba(0, 40, 60, 0.2) 0%, transparent 60%), #050505;
            color: var(--text-main);
            font-family: var(--font-sans);
            min-height: 100vh;
            padding: 1.25rem;
        }

        .shell {
            max-width: 1200px;
            margin: 0 auto;
            border: 1px solid var(--glass-border);
            background: rgba(8, 12, 16, 0.8);
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .title {
            font-family: var(--font-mono);
            letter-spacing: 0.12em;
            font-weight: 700;
            color: var(--accent-cyan);
        }

        .actions {
            display: flex;
            gap: 0.6rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .pill-btn {
            border: 1px solid var(--glass-border);
            background: rgba(0, 240, 255, 0.08);
            color: var(--text-main);
            font-family: var(--font-mono);
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            padding: 0.45rem 0.9rem;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s;
        }

        .pill-btn.secondary {
            background: rgba(213, 0, 249, 0.1);
            border-color: rgba(213, 0, 249, 0.3);
        }

        .pill-btn:hover {
            box-shadow: 0 0 10px rgba(0, 240, 255, 0.2);
            color: var(--accent-cyan);
        }

        .toolbar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 0.75rem;
            align-items: center;
        }

        .search-input,
        .select-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: var(--text-main);
            padding: 0.5rem 0.65rem;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            width: 100%;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
        }

        .card {
            border: 1px solid var(--glass-border);
            background: rgba(0, 240, 255, 0.03);
            padding: 0.9rem;
            font-family: var(--font-mono);
            letter-spacing: 0.08em;
        }

        .card strong {
            display: block;
            font-size: 1.2rem;
            color: var(--accent-success);
        }

        .table {
            border: 1px solid var(--glass-border);
            background: rgba(4, 7, 10, 0.9);
            overflow: hidden;
        }

        .table-head,
        .row {
            display: grid;
            grid-template-columns: 2.2fr 1.1fr 1fr 1fr 1.8fr 90px;
            align-items: center;
            padding: 0.75rem 0.9rem;
            gap: 0.6rem;
        }

        .table-head {
            background: rgba(0, 0, 0, 0.35);
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--text-muted);
            letter-spacing: 0.06em;
            text-transform: uppercase;
        }

        .row {
            border-top: 1px solid rgba(255, 255, 255, 0.04);
        }

        .row:hover {
            background: rgba(0, 240, 255, 0.04);
        }

        .job-title {
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        .job-company {
            color: var(--accent-purple);
            font-family: var(--font-mono);
            font-size: 0.75rem;
        }

        .tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .tag {
            font-family: var(--font-mono);
            font-size: 0.65rem;
            padding: 2px 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-muted);
        }

        .link {
            text-align: right;
            color: var(--accent-cyan);
            font-family: var(--font-mono);
            text-decoration: none;
        }

        .status {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--text-muted);
        }
    </style>
</head>

<body>
    <div class="shell">
        <div class="header">
            <div class="title">WARP.JOBS // DATA EXPLORER</div>
            <div class="actions">
                <a class="pill-btn" href="jobs_dashboard.html">Open Dashboard</a>
                <button class="pill-btn secondary" id="reloadBtn">Reload Data</button>
            </div>
        </div>

        <div class="toolbar">
            <input class="search-input" type="search" id="searchInput" placeholder="Search title, company, tags, host">
            <select class="select-input" id="hostFilter">
                <option value="all">All job sites</option>
            </select>
            <div class="status" id="statusText">Dataset: loading...</div>
        </div>

        <div class="stats">
            <div class="card">Jobs <strong id="jobCount">--</strong></div>
            <div class="card">Sites <strong id="siteCount">--</strong></div>
        </div>

        <div class="table">
            <div class="table-head">
                <div>Role</div>
                <div>Company</div>
                <div>Location</div>
                <div>Site</div>
                <div>Tags</div>
                <div style="text-align: right;">Link</div>
            </div>
            <div id="tableBody"></div>
        </div>
    </div>

    <script>
        const DATA_URL = 'jobs_data.json';
        const fallbackJobs = [
            {
                title: "Research Scientist, Extended Reality",
                company: "Google",
                location: "San Jose, CA",
                date_posted: "2d ago",
                salary_range: "$141k - $202k",
                url: "https://careers.google.com/jobs/results/?q=Research%20Scientist%20Extended%20Reality",
                tags: ["XR", "Hand Tracking", "AI", "Research", "C++", "Python", "US"],
                description: "Direct fit for Hand Tracking & AI convergence research priorities. Focus on 3D capture systems."
            },
            {
                title: "Senior Graphics Engineer",
                company: "NVIDIA",
                location: "Santa Clara, CA",
                date_posted: "1d ago",
                salary_range: "$180k - $260k",
                url: "https://nvidia.wd5.myworkdayjobs.com/NVIDIAExternalCareerSite?q=Neural%20Rendering",
                tags: ["Neural Rendering", "Graphics", "C++", "CUDA", "Vulkan", "US"],
                description: "Critical role for Neural Rendering pipeline optimization & NeRF integration."
            },
            {
                title: "Staff AI Software Engineer",
                company: "Google (Labs)",
                location: "Mountain View, CA",
                date_posted: "2d ago",
                salary_range: "$197k - $291k",
                url: "https://careers.google.com/jobs/results/?q=Staff%20AI%20Software%20Engineer%20Rapid%20Prototyping",
                tags: ["AI", "Rapid Prototyping", "Audio", "Mobile", "US"],
                description: "High impact role in Rapid Prototyping. Building zero-to-one AI products."
            }
        ];

        let jobs = [];
        let searchTerm = '';
        let hostFilter = 'all';

        const els = {
            tableBody: document.getElementById('tableBody'),
            jobCount: document.getElementById('jobCount'),
            siteCount: document.getElementById('siteCount'),
            hostFilter: document.getElementById('hostFilter'),
            searchInput: document.getElementById('searchInput'),
            statusText: document.getElementById('statusText'),
            reloadBtn: document.getElementById('reloadBtn')
        };

        const regionTags = ['us', 'uk', 'remote', 'eu', 'ca', 'apac', 'latam'];

        function safeHost(url) {
            try {
                return new URL(url).hostname.replace(/^www\./, '');
            } catch {
                return 'unknown';
            }
        }

        function normalizeJob(job, index) {
            const rawTags = Array.isArray(job.tags) ? job.tags : [];
            const tagsNormalized = rawTags.map(t => String(t).toLowerCase());
            const stack = (job.stack || rawTags).filter(t => !regionTags.includes(String(t).toLowerCase()));
            return {
                id: job.id || `job_${index}`,
                title: job.title || 'Untitled role',
                company: job.company || 'UNKNOWN',
                location: job.location || 'Remote',
                posted: job.posted || job.date_posted || '—',
                salary: job.salary || job.salary_range || 'Competitive',
                url: job.url || '#',
                tags: rawTags,
                tagsNormalized,
                stack,
                host: safeHost(job.url),
                description: job.description || job.insight || ''
            };
        }

        function populateHosts() {
            const hosts = Array.from(new Set(jobs.map(j => j.host))).sort();
            els.hostFilter.innerHTML = '<option value="all">All job sites</option>' + hosts.map(h => `<option value="${h}">${h}</option>`).join('');
        }

        function matchesSearch(job) {
            if (!searchTerm) return true;
            const q = searchTerm.toLowerCase();
            const haystack = [job.title, job.company, job.location, job.description, job.tags.join(' '), job.host].join(' ').toLowerCase();
            return haystack.includes(q);
        }

        function matchesHost(job) {
            if (hostFilter === 'all') return true;
            return job.host === hostFilter;
        }

        function render() {
            const filtered = jobs.filter(j => matchesHost(j) && matchesSearch(j));
            els.jobCount.textContent = filtered.length;
            els.siteCount.textContent = new Set(jobs.map(j => j.host)).size;
            els.tableBody.innerHTML = '';

            filtered.forEach(job => {
                const row = document.createElement('div');
                row.className = 'row';
                row.innerHTML = `
                    <div>
                        <div class="job-title">${job.title}</div>
                        <div style="opacity: 0.7; font-family: var(--font-mono); font-size: 0.75rem;">${job.posted} · ${job.salary}</div>
                    </div>
                    <div>${job.company}</div>
                    <div>${job.location}</div>
                    <div>${job.host}</div>
                    <div class="tags">${job.stack.slice(0, 8).map(t => `<span class="tag">${t}</span>`).join('')}</div>
                    <div class="link"><a class="link" href="${job.url}" target="_blank" rel="noopener">Open</a></div>
                `;
                els.tableBody.appendChild(row);
            });
        }

        async function loadData() {
            els.statusText.textContent = 'Dataset: loading...';
            try {
                const response = await fetch(DATA_URL, { cache: 'no-store' });
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const data = await response.json();
                jobs = data.map((job, i) => normalizeJob(job, i));
                els.statusText.textContent = 'Dataset: live (jobs_data.json)';
            } catch (err) {
                console.warn('Explorer fallback data engaged', err);
                jobs = fallbackJobs.map((job, i) => normalizeJob(job, i));
                els.statusText.textContent = 'Dataset: fallback (bundled sample)';
            }
            populateHosts();
            render();
        }

        function bind() {
            els.searchInput.addEventListener('input', (e) => {
                searchTerm = e.target.value;
                render();
            });
            els.hostFilter.addEventListener('change', (e) => {
                hostFilter = e.target.value;
                render();
            });
            els.reloadBtn.addEventListener('click', loadData);
        }

        bind();
        loadData();
    </script>
</body>

</html>
